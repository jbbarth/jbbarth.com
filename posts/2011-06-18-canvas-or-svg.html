<!DOCTYPE html>
<html>
  <head>
    <title>jbbarth.com - Canvas or SVG</title>
    <link href="http://fonts.googleapis.com/css?family=Lobster+Two:700|Open+Sans:400,600,700" rel="stylesheet" type="text/css">
    <link rel="stylesheet" type="text/css" media="all" href="/stylesheets/reset.css" />
    <link rel="stylesheet" type="text/css" media="all" href="/stylesheets/text.css" />
    <link rel="stylesheet" type="text/css" media="all" href="/stylesheets/960.css" />
    <link rel="stylesheet" type="text/css" media="all" href="/stylesheets/app.css" />
    <link rel="stylesheet" type="text/css" media="all" href="/stylesheets/rainbow/github.css" />
    <script type="text/javascript" src="/javascripts/jquery-1.8.2.min.js"></script>
    <script type="text/javascript" src="/javascripts/rainbow-custom.min.js"></script>
    <script type="text/javascript" src="/javascripts/app.js"></script>
    <meta http-equiv="cache-control" content="max-age=10, must-revalidate" />
    <meta charset="utf-8">
    <meta name="generator" content="nanoc 3.2.3">
  </head>
  <body>
    <div id="container" class="container_16">
      <div class="grid_4">
        <div id="sidebar">
  <div class=sitetitle>
    <a href="/">jbbarth.com</a>
  </div>
  <p>
    I'm a sysadmin &amp; developer from Paris, France. I love building tools for
    ops, and I'm an irregular contributor to many open-source projects. More
    <a href="/portfolio.html">here</a>.
  </p>
</div>

      </div>
      <div class="grid_12">
        <div id="content">
          <h1>Canvas or SVG</h1>

<p>The choice is not easy in this case…</p>

<p><strong><span class="caps">EDIT</span></strong>: just a quick note, it’s not an other <span class="caps">SVG</span> vs Canvas comparison. My “Canvas”
version uses pure HTML+jQuery things so there’s a bias I’m totally aware of.</p>

<p>Recently I <a href="http://jbbarth.com/archives/2011/6/17/playing_with_canvas/">blogged about an experiment</a> I was making for building logical maps of
an application architecture, e.g. servers, components, arrows to represent relations between servers, etc. It was built with HTML’s Canvas and dirty
Javascript code, but I was pretty sure I would switch to CoffeeScript and <span class="caps">SVG</span> (with <a href="http://raphaeljs.com/">RaphaelJS</a>
library).</p>

<p>After a day of work, I have started the switch to <a href="http://jashkenas.github.com/coffee-script/">CoffeeScript</a> and <a href=
"http://pivotal.github.com/jasmine/">Jasmine</a>. It’s not finished yet, but it’s moving fast, no problem on that side. All the code is now pure client code,
I’ve migrated the few functions I had in Ruby/<span class="caps">ERB</span> to Javascript. I even started to tweak and read a Cakefile (<a href=
"http://jashkenas.github.com/coffee-script/documentation/docs/cake.html">doc</a>) to ease build actions and organize my code. I’m really impressed with
CoffeeScript so far, it’s amazingly concise and has some high-level concepts to make Javascript easier. Feels good !</p>

<p>On the <span class="caps">SVG</span> side, I’m not that happy. I managed to have the basic things working :</p>

<ul>
  <li>draw boxes</li>

  <li>position boxes automatically</li>

  <li>put text in each box</li>

  <li>make boxes draggable</li>

  <li>draw links dynamically between related boxes</li>
</ul>

<p>Here’s a screenshot of the result :</p>

<p style="text-align:center;"><img src="/images/articles/canvas-svg-itmap.png" alt=""></p>

<p>But I miss a lot of things :</p>

<ul>
  <li>collision detection ? seems I have to write my own</li>

  <li>grouping management ? same, <span class="caps">SVG</span> doesn’t support it, so I had to write some basic stuff to make pieces of text move with their
  box</li>

  <li>text flow ? nothing, so I have to fix height manually on boxes</li>

  <li>styling elements : <span class="caps">SVG</span> doesn’t rely on <span class="caps">CSS</span> (I can retrieve properties and translate them, but it’ll
  be tiresome)</li>

  <li>can’t style rectangle borders under 2px (it’s ugly)</li>
</ul>

<p>On the other hand, it comes with good things that I won’t have with Canvas :</p>

<ul>
  <li>drag/drop work on iPhone/iPad</li>

  <li>vectors : you keep high-quality rendering when zooming</li>

  <li>animations : not useful now, but maybe later</li>

  <li>everything is an object, so I won’t have to re-draw the whole map when there’s a change</li>
</ul>

<p>The repo is finally <a href="https://github.com/jbbarth/itmap">on github</a> and you can watch <a href="http://jbbarth.com/itmap/public/index.html">a live
demo here</a> where both methods are displayed side by side : Canvas on the left, <span class="caps">SVG</span> on the right.</p>

<p>Now I don’t really know what to do. Everything would be easier if you could embed <span class="caps">HTML</span> trees in an <span class="caps">SVG</span>
element, but it’s not possible by default. I started to play with a Raphael plugin called <a href=
"https://github.com/kreynolds/RaphaelJS-Infobox">Infobox</a> so I keep <span class="caps">HTML</span> for representing servers. The idea would be to manage a
grid and the boxes only with <span class="caps">SVG</span>, and have <span class="caps">HTML</span> embedded in it so it solves styling/flow problems. It
works with some effort, but it starts to become pretty complicated, and there are still a lot of problems to solve.</p>

<p>It seems there’s no magical solution in the <span class="caps">SVG</span>/Canvas world (for now). Any suggestion would be welcome.</p>

        </div>
      </div>
    </div>
    <script type="text/javascript">
      var _gauges = _gauges || [];
      (function() {
        var t   = document.createElement('script');
        t.type  = 'text/javascript';
        t.async = true;
        t.id    = 'gauges-tracker';
        t.setAttribute('data-site-id', '4e3bca6b613f5d70ee000001');
        t.src = '//secure.gaug.es/track.js';
        var s = document.getElementsByTagName('script')[0];
        s.parentNode.insertBefore(t, s);
      })();
    </script>
  </body>
</html>
